<!--
  ~ Copyright (C) 2016 Brockmann Consult GmbH (info@brockmann-consult.de)
  ~ Copyright (C) 2016 Javier Gorrono, National Physical Laboratory (javier.gorrono@npl.co.uk)
  ~
  ~ This program is free software; you can redistribute it and/or modify it
  ~ under the terms of the GNU General Public License as published by the Free
  ~ Software Foundation; either version 3 of the License, or (at your option)
  ~ any later version.
  ~ This program is distributed in the hope that it will be useful, but WITHOUT
  ~ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  ~ FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
  ~ more details.
  ~
  ~ You should have received a copy of the GNU General Public License along
  ~ with this program; if not, see http://www.gnu.org/licenses/
  -->

<html>
<head>
    <title>S2-RUT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="stylesheet" href="style.css">
</head>

<body>
<table class="header">
    <tr class="header">
        <td class="header">S2-RUT Processor Documentation</td>
        <td class="header" align="right"><img src="images/snap_header.jpg" border=0></td>
    </tr>
</table>

<h3>User Interface</h3>

<p>
    The S2-RUT processor can be invoked in the Sentinel Toolbox from the menu by selecting
    <b>Optical->Preprocessing->Sentinel-2 Radiometric Uncertainty Tool</b>.
    On the command line processor is available by means of the Graph Processing Tool <code>gpt</code>
    which is located in the Sentinel Toolbox <code>bin</code> directory.
    Typing <code>gpt S2Rut -h</code> displays further information. For example, the code below processes the uncertainty
    for bands B1, B2 and B3 with the specific input product and output product:
</p>
<p><code>gpt S2RutOp -Ssource="/PATH_TO_PRODUCT/S2A_MSIL1C_20180220T105051_N0206_R051_T30SYJ_20180221T134037.SAFE" -t
    "PATH_TO_FOLDER_WITH_S2_PRODUCTS/S2A_MSIL1C_20180220T105051_N0206_R051_T30SYJ_20180221T134037_rut.dim"
    -Pband_names="B1,B2,B3"</code>
</p>
<p>
    Selecting the <b>Sentinel-2 Radiometric Uncertainty Tool</b> command from the Sentinel Toolbox menu opens up the
    following dialog:
</p>

<p align="center"><img src="images/IOParameters.png"></p>

<h5>Source Product Group</h5>

<p class="i1">
    <b>Source product:</b>
    Here the user specifies the source product.
    The combo box presents a list of all products opened in the Sentinel Toolbox.
    The user may select one of these or, by clicking on the button next to the combo box, choose a product
    from the file system. The selected product must be of type <b>S2_MSI_Level-1C</b>.
</p>

<h5>Target Product Group</h5>

<p class="i1">
    <b>Name:</b>
    Used to specify the name of the target product.
</p>

<p class="i1">
    <b>Save as:</b>
    Used to specify whether the target product should be saved to the file system. The
    combo box presents a list of available file formats.
    The text field or the button next to it allow to specify a target directory.
</p>

<p class="i1">
    <b>Open in SNAP:</b>
    Used to specify whether the target product should be opened in the Sentinel Toolbox.
    When the target product is not saved, it is opened in the Sentinel Toolbox automatically.
</p>

<p align="center"><img src="images/ProcessingParameters.png"></p>

<h5>Processing Parameters</h5>

<p class="i1">
    <b>Coverage factor:</b> The value of the coverage factor for the uncertainty
    evaluation (<i>k</i>=1 means 68.27% probability):
</p>
<p class="i1">
    <b>Band names:</b> Write down the bands for which the uncertainty shall be computed. All valid bands are written by
    default. NOTE: No space between commas is required (see image above)
</p>
<p class="i1">
    <b>Instrument noise:</b> Noise (shot, thermal, etc.) introduced by the silicon and CMT detectors of the MSI
    instrument
</p>
<p class="i1">
    <b>OOF straylight-systematic:</b> Telescope Out-Of-Field light that results in a positive bias
</p>
<p class="i1">
    <b>OOF straylight-random:</b> Focal plane Out-Of-Field light that results in a random spatial dispersion
</p>
<p class="i1">
    <b>Crosstalk:</b> Focal plane (Optical) and Front-End Electronics (electrical) inter-band signal
</p>
<p class="i1">
    <b>ADC quantisation:</b> Analog to Digital conversion at the Video Chain Unit on-board the MSI
</p>
<p class="i1">
    <b>DS stability:</b> Residual thermal fluctuations of the detector offset along the orbit
</p>
<p class="i1">
    <b>Gamma knowledge:</b> Knowledge on te correction for non-linearity and non-uniformity
</p>
<p class="i1">
    <b>Diffuser-absolute knowledge:</b> Knowledge on the diffuser reflectance factor (BRF)
</p>
<p class="i1">
    <b>Diffuser-temporal knowledge:</b> Estimated effect of the diffuser degradation in space
</p>
<p class="i1">
    <b>Diffuser-cosine effect:</b> Cosine correction knowledge as a consequence of angular noise TBD
</p>
<p class="i1">
    <b>Diffuser-straylight_residual:</b> Residual for the correction of the stray-light during in-flight diffuser
    calibration
</p>
<p class="i1">
    <b>L1C image quantisation:</b> Effect of the finite resolution of the L1C reflectance factor
</p>

<br>
<hr>
</body>
</html>
